EESchema Schematic File Version 4
EELAYER 30 0
EELAYER END
$Descr USLetter 11000 8500
encoding utf-8
Sheet 1 7
Title "RoMeLa Motor Gen2"
Date "2020-04-20"
Rev "1.0"
Comp "Robotics & Mechanisms Labratory(RoMeLa) UCLA"
Comment1 "Author: Tym Zhu"
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Sheet
S 4450 1900 1550 3350
U 5827F7AC
F0 "stm32" 60
F1 "stm32.sch" 60
F2 "ENGATE" O R 6000 2150 60 
F3 "H1" O R 6000 2300 60 
F4 "H2" O R 6000 2400 60 
F5 "H3" O R 6000 2500 60 
F6 "DRV8305_SCS" O R 6000 2700 60 
F7 "DRV8305_SCLK" O R 6000 2800 60 
F8 "DRV8305_MOSI" O R 6000 2900 60 
F9 "DRV8305_MISO" I R 6000 3000 60 
F10 "FAULT" I R 6000 3150 60 
F11 "PVDDSENSE" I R 6000 3400 60 
F12 "ADC_SDO" O R 6000 4200 60 
F13 "ADC_SDI" I R 6000 4400 60 
F14 "ADC_CLK" O R 6000 4600 60 
F15 "ENC_CSn" O L 4450 3150 60 
F16 "ENC_SCL" O L 4450 3250 60 
F17 "ENC_MISO" I L 4450 3350 60 
F18 "ENC_MOSI" O L 4450 3450 60 
F19 "485_RX" I L 4450 2350 60 
F20 "485_TXEN" O L 4450 2500 60 
F21 "485_TX" O L 4450 2650 60 
F22 "TC_nCS" O L 4450 4100 60 
F23 "TC_SCK" O L 4450 4200 60 
F24 "TC_SO" I L 4450 4300 60 
F25 "I2C_SDA" B L 4450 4550 60 
F26 "I2C_SCL" O L 4450 4650 60 
F27 "ADC_CS" O R 6000 4800 60 
F28 "EXT_DI" I L 4450 2200 60 
F29 "DRV_ENABLE" O R 6000 2050 60 
$EndSheet
$Sheet
S 6400 1900 1500 1750
U 58280BEC
F0 "Power_Stage" 60
F1 "Power_Stage.sch" 60
F2 "ENGATE" I L 6400 2150 60 
F3 "H1" I L 6400 2300 60 
F4 "H2" I L 6400 2400 60 
F5 "H3" I L 6400 2500 60 
F6 "SCS" I L 6400 2700 60 
F7 "SCLK" I L 6400 2800 60 
F8 "SDI" I L 6400 2900 60 
F9 "SDO" O L 6400 3000 60 
F10 "FAULT" O L 6400 3150 60 
F11 "MOTOR_A" O R 7900 2150 60 
F12 "MOTOR_B" O R 7900 2350 60 
F13 "MOTOR_C" O R 7900 2550 60 
F14 "Shunt_A_P" O R 7900 3050 60 
F15 "Shunt_A_N" O R 7900 3150 60 
F16 "Shunt_C_P" O R 7900 3350 60 
F17 "Shunt_C_N" O R 7900 3450 60 
F18 "PVDDSENSE" O L 6400 3400 60 
F19 "DRV_ENABLE" I L 6400 2050 60 
$EndSheet
$Sheet
S 6400 3950 1500 1300
U 5828F3AC
F0 "Current_ADC" 60
F1 "Current_ADC.sch" 60
F2 "AIN+" I R 7900 4450 60 
F3 "AIN-" I R 7900 4350 60 
F4 "CIN+" I R 7900 4200 60 
F5 "CIN-" I R 7900 4100 60 
F6 "DOUT" O L 6400 4400 60 
F7 "DIN" I L 6400 4200 60 
F8 "CLK" I L 6400 4600 60 
F9 "~CS" I L 6400 4800 60 
$EndSheet
$Sheet
S 2950 4000 1000 900 
U 5829AC99
F0 "Thermal" 60
F1 "Thermal.sch" 60
F2 "T+" I L 2950 4200 60 
F3 "T-" I L 2950 4350 60 
F4 "TC_nCS" I R 3950 4100 60 
F5 "TC_SCK" I R 3950 4200 60 
F6 "TC_SO" O R 3950 4300 60 
F7 "I2C_SDA" B R 3950 4550 60 
F8 "I2C_SCL" I R 3950 4650 60 
$EndSheet
$Sheet
S 2950 3000 1000 700 
U 5829B004
F0 "Encoder" 60
F1 "Encoder.sch" 60
F2 "CSn" I R 3950 3150 60 
F3 "CLK" I R 3950 3250 60 
F4 "MISO" O R 3950 3350 60 
F5 "MOSI" I R 3950 3450 60 
F6 "BATT+" I L 2950 3250 60 
F7 "BATT-" I L 2950 3550 60 
$EndSheet
$Comp
L Device:R_Small R1
U 1 1 58299209
P 2400 1650
F 0 "R1" V 2300 1500 50  0000 L CNN
F 1 "120*" V 2300 1650 50  0000 L CNN
F 2 "Resistor_SMD:R_0603_1608Metric" H 2400 1650 50  0001 C CNN
F 3 "" H 2400 1650 50  0000 C CNN
	1    2400 1650
	0    1    1    0   
$EndComp
$Comp
L power:GNDREF #PWR03
U 1 1 5829962A
P 2600 1650
F 0 "#PWR03" H 2600 1400 50  0001 C CNN
F 1 "GNDREF" H 2600 1500 50  0000 C CNN
F 2 "" H 2600 1650 50  0000 C CNN
F 3 "" H 2600 1650 50  0000 C CNN
	1    2600 1650
	1    0    0    -1  
$EndComp
$Comp
L Connector_Generic:Conn_01x02 P6
U 1 1 582AC713
P 2100 4300
F 0 "P6" H 2100 4450 50  0000 C CNN
F 1 "CONN_TC" V 2200 4300 50  0000 C CNN
F 2 "RoMeLa_Motor:JST_SH_SM02B-SRSS-TB_1x02-1MP_P1.00mm_Horizontal" H 2100 4300 50  0001 C CNN
F 3 "" H 2100 4300 50  0000 C CNN
	1    2100 4300
	-1   0    0    1   
$EndComp
$Comp
L Connector:TestPoint P2
U 1 1 582AB0F8
P 7900 2150
F 0 "P2" V 7800 2300 50  0000 C CNN
F 1 "MT_A" V 7900 2450 50  0000 C CNN
F 2 "RoMeLa_Motor:Motor_winding_SMT" H 8100 2150 50  0001 C CNN
F 3 "" H 8100 2150 50  0000 C CNN
	1    7900 2150
	0    1    1    0   
$EndComp
$Comp
L Connector:TestPoint P3
U 1 1 582ABC63
P 7900 2350
F 0 "P3" V 7800 2500 50  0000 C CNN
F 1 "MT_B" V 7900 2650 50  0000 C CNN
F 2 "RoMeLa_Motor:Motor_winding_SMT" H 8100 2350 50  0001 C CNN
F 3 "" H 8100 2350 50  0000 C CNN
	1    7900 2350
	0    1    1    0   
$EndComp
$Comp
L Connector:TestPoint P4
U 1 1 582ABE29
P 7900 2550
F 0 "P4" V 7800 2700 50  0000 C CNN
F 1 "MT_C" V 7900 2850 50  0000 C CNN
F 2 "RoMeLa_Motor:Motor_winding_SMT" H 8100 2550 50  0001 C CNN
F 3 "" H 8100 2550 50  0000 C CNN
	1    7900 2550
	0    1    1    0   
$EndComp
Wire Wire Line
	6000 2150 6400 2150
Wire Wire Line
	6000 2300 6400 2300
Wire Wire Line
	6400 2400 6000 2400
Wire Wire Line
	6000 2500 6400 2500
Wire Wire Line
	6400 2700 6000 2700
Wire Wire Line
	6000 2800 6400 2800
Wire Wire Line
	6400 2900 6000 2900
Wire Wire Line
	6000 3000 6400 3000
Wire Wire Line
	6000 3150 6400 3150
Wire Wire Line
	6000 3400 6400 3400
Wire Wire Line
	7900 3150 8100 3150
Wire Wire Line
	8100 3150 8100 4450
Wire Wire Line
	8150 4350 8150 3050
Wire Wire Line
	8150 3050 7900 3050
Wire Wire Line
	7900 4100 7950 4100
Wire Wire Line
	7950 4100 7950 3450
Wire Wire Line
	7950 3450 7900 3450
Wire Wire Line
	7900 3350 8000 3350
Wire Wire Line
	8000 3350 8000 4200
Wire Wire Line
	8000 4200 7900 4200
Wire Wire Line
	6400 4400 6000 4400
Wire Wire Line
	6000 4600 6400 4600
Wire Wire Line
	3950 3150 4450 3150
Wire Wire Line
	4450 3250 3950 3250
Wire Wire Line
	3950 3350 4450 3350
Wire Wire Line
	4450 3450 3950 3450
Wire Wire Line
	2500 1650 2600 1650
Wire Wire Line
	3950 2650 4450 2650
Wire Wire Line
	4450 2500 3950 2500
Wire Wire Line
	3950 2350 4450 2350
Wire Wire Line
	2300 4200 2950 4200
Wire Wire Line
	2950 4350 2300 4350
Wire Wire Line
	2300 4350 2300 4300
Wire Wire Line
	3950 4650 4450 4650
Wire Wire Line
	4450 4550 3950 4550
Wire Wire Line
	3950 4300 4450 4300
Wire Wire Line
	4450 4200 3950 4200
Wire Wire Line
	3950 4100 4450 4100
$Comp
L power:+48V #PWR01
U 1 1 5832C1E8
P 8900 1450
F 0 "#PWR01" H 8900 1300 50  0001 C CNN
F 1 "+48V" H 8900 1590 50  0000 C CNN
F 2 "" H 8900 1450 50  0000 C CNN
F 3 "" H 8900 1450 50  0000 C CNN
	1    8900 1450
	1    0    0    -1  
$EndComp
Wire Wire Line
	8150 4350 7900 4350
Wire Wire Line
	8100 4450 7900 4450
$Comp
L power:GNDPWR #PWR02
U 1 1 5832E244
P 8900 1550
F 0 "#PWR02" H 8900 1350 50  0001 C CNN
F 1 "GNDPWR" H 8900 1420 50  0000 C CNN
F 2 "" H 8900 1500 50  0000 C CNN
F 3 "" H 8900 1500 50  0000 C CNN
	1    8900 1550
	1    0    0    -1  
$EndComp
Wire Wire Line
	6000 4200 6400 4200
Wire Wire Line
	6000 4800 6400 4800
Wire Wire Line
	3950 2200 4450 2200
$Comp
L Connector_Generic:Conn_01x06 J2
U 1 1 5EA13651
P 1450 2550
F 0 "J2" H 1600 2250 50  0000 C CNN
F 1 "PicoBlade 6P" H 1600 2850 50  0000 C CNN
F 2 "RoMeLa_Motor:Molex_PicoBlade_53048-0650_1x06_P1.25mm_Horizontal" H 1450 2550 50  0001 C CNN
F 3 "~" H 1450 2550 50  0001 C CNN
	1    1450 2550
	-1   0    0    -1  
$EndComp
$Comp
L Connector_Generic:Conn_01x06 J1
U 1 1 5EA1E3F2
P 1450 1850
F 0 "J1" H 1600 1550 50  0000 C CNN
F 1 "PicoBlade 6P" H 1600 2150 50  0000 C CNN
F 2 "RoMeLa_Motor:Molex_PicoBlade_53048-0650_1x06_P1.25mm_Horizontal" H 1450 1850 50  0001 C CNN
F 3 "~" H 1450 1850 50  0001 C CNN
	1    1450 1850
	-1   0    0    -1  
$EndComp
Wire Wire Line
	1650 2550 2050 2550
Wire Wire Line
	1650 1850 2050 1850
Wire Wire Line
	2050 1850 2050 2550
Wire Wire Line
	1650 1650 2250 1650
Wire Wire Line
	2250 2350 2250 1650
Wire Wire Line
	1650 2350 2250 2350
Connection ~ 2250 1650
Wire Wire Line
	2250 1650 2300 1650
Wire Wire Line
	1650 1750 2150 1750
Wire Wire Line
	2150 1750 2150 2450
Wire Wire Line
	2150 2450 1650 2450
Wire Wire Line
	1650 1950 1950 1950
Wire Wire Line
	1950 1950 1950 2650
Wire Wire Line
	1950 2650 1650 2650
Connection ~ 1950 2650
Wire Wire Line
	1650 2050 1850 2050
Wire Wire Line
	1850 2050 1850 2750
Wire Wire Line
	1850 2750 1650 2750
Wire Wire Line
	1650 2150 1750 2150
Wire Wire Line
	1750 2150 1750 2850
Wire Wire Line
	1750 2850 1650 2850
$Sheet
S 2950 2050 1000 700 
U 5829ADB5
F0 "RS485" 60
F1 "RS485.sch" 60
F2 "RxD" O R 3950 2350 60 
F3 "DE/nRE" I R 3950 2500 60 
F4 "TxD" I R 3950 2650 60 
F5 "A" B L 2950 2500 60 
F6 "B" B L 2950 2650 60 
F7 "ISO_DI" I L 2950 2200 60 
F8 "EXT_DI" O R 3950 2200 60 
$EndSheet
Wire Wire Line
	1950 2650 2950 2650
Wire Wire Line
	2050 2550 2850 2550
Wire Wire Line
	2850 2550 2850 2500
Wire Wire Line
	2850 2500 2950 2500
Connection ~ 2050 2550
Wire Wire Line
	2150 2450 2750 2450
Wire Wire Line
	2750 2450 2750 2200
Wire Wire Line
	2750 2200 2950 2200
Connection ~ 2150 2450
$Comp
L Device:Battery_Cell BT1
U 1 1 5EA51518
P 2250 3450
F 0 "BT1" H 2050 3600 50  0000 L CNN
F 1 "Batt 3.6V" H 1850 3400 50  0000 L CNN
F 2 "RoMeLa_Motor:ABH1_2AA" V 2250 3510 50  0001 C CNN
F 3 "~" V 2250 3510 50  0001 C CNN
	1    2250 3450
	1    0    0    -1  
$EndComp
$Comp
L Connector_Generic:Conn_01x02 P5
U 1 1 5EA52F07
P 1450 3550
F 0 "P5" H 1450 3700 50  0000 C CNN
F 1 "CONN_BATT" V 1550 3550 50  0000 C CNN
F 2 "RoMeLa_Motor:JST_SH_SM02B-SRSS-TB_1x02-1MP_P1.00mm_Horizontal" H 1450 3550 50  0001 C CNN
F 3 "" H 1450 3550 50  0000 C CNN
	1    1450 3550
	-1   0    0    1   
$EndComp
Wire Wire Line
	1650 3550 2250 3550
Connection ~ 2250 3550
Wire Wire Line
	2250 3250 2950 3250
Wire Wire Line
	2250 3550 2950 3550
Wire Wire Line
	1650 3450 1800 3450
Wire Wire Line
	1800 3450 1800 3250
Wire Wire Line
	1800 3250 2250 3250
Connection ~ 2250 3250
$Comp
L power:GNDPWR #PWR0113
U 1 1 5E0E9B26
P 2050 6300
F 0 "#PWR0113" H 2050 6100 50  0001 C CNN
F 1 "GNDPWR" H 2050 6170 50  0000 C CNN
F 2 "" H 2050 6250 50  0000 C CNN
F 3 "" H 2050 6250 50  0000 C CNN
	1    2050 6300
	1    0    0    -1  
$EndComp
$Comp
L Mechanical:MountingHole_Pad H1
U 1 1 5E0FA87A
P 2050 5600
F 0 "H1" H 2150 5649 50  0000 L CNN
F 1 "MT" H 2150 5558 50  0000 L CNN
F 2 "MountingHole:MountingHole_2.7mm_M2.5_Pad_Via" H 2050 5600 50  0001 C CNN
F 3 "~" H 2050 5600 50  0001 C CNN
	1    2050 5600
	1    0    0    -1  
$EndComp
$Comp
L Connector:TestPoint P1
U 1 1 5E2D6D9C
P 8900 1450
F 0 "P1" V 8850 1650 50  0000 C CNN
F 1 "+IN" V 8900 1750 50  0000 C CNN
F 2 "RoMeLa_Motor:Motor_winding_SMT" H 9100 1450 50  0001 C CNN
F 3 "" H 9100 1450 50  0000 C CNN
	1    8900 1450
	0    1    1    0   
$EndComp
$Comp
L Connector:TestPoint P11
U 1 1 5E2D7645
P 8900 1550
F 0 "P11" V 8950 1750 50  0000 C CNN
F 1 "-IN" V 8900 1850 50  0000 C CNN
F 2 "RoMeLa_Motor:Motor_winding_SMT" H 9100 1550 50  0001 C CNN
F 3 "" H 9100 1550 50  0000 C CNN
	1    8900 1550
	0    1    1    0   
$EndComp
$Comp
L Mechanical:MountingHole_Pad H2
U 1 1 5E2E12CF
P 2350 5600
F 0 "H2" H 2450 5649 50  0000 L CNN
F 1 "MT" H 2450 5558 50  0000 L CNN
F 2 "MountingHole:MountingHole_2.7mm_M2.5_Pad_Via" H 2350 5600 50  0001 C CNN
F 3 "~" H 2350 5600 50  0001 C CNN
	1    2350 5600
	1    0    0    -1  
$EndComp
$Comp
L Mechanical:MountingHole_Pad H3
U 1 1 5E2E15B2
P 2650 5600
F 0 "H3" H 2750 5649 50  0000 L CNN
F 1 "MT" H 2750 5558 50  0000 L CNN
F 2 "MountingHole:MountingHole_2.7mm_M2.5_Pad_Via" H 2650 5600 50  0001 C CNN
F 3 "~" H 2650 5600 50  0001 C CNN
	1    2650 5600
	1    0    0    -1  
$EndComp
$Comp
L Mechanical:MountingHole_Pad H4
U 1 1 5E2E1805
P 2950 5600
F 0 "H4" H 3050 5649 50  0000 L CNN
F 1 "MT" H 3050 5558 50  0000 L CNN
F 2 "MountingHole:MountingHole_2.7mm_M2.5_Pad_Via" H 2950 5600 50  0001 C CNN
F 3 "~" H 2950 5600 50  0001 C CNN
	1    2950 5600
	1    0    0    -1  
$EndComp
Wire Wire Line
	2950 5700 2650 5700
Wire Wire Line
	2350 5700 2650 5700
Connection ~ 2650 5700
Wire Wire Line
	2350 5700 2050 5700
Connection ~ 2350 5700
$Comp
L Device:C_Small C?
U 1 1 5E2FC9E6
P 2050 6000
AR Path="/58280BEC/5E2FC9E6" Ref="C?"  Part="1" 
AR Path="/5E2FC9E6" Ref="C26"  Part="1" 
F 0 "C26" H 2150 6050 50  0000 L CNN
F 1 "4.7nF 1kv" H 2150 5950 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric" H 2050 6000 50  0001 C CNN
F 3 "" H 2050 6000 50  0000 C CNN
	1    2050 6000
	1    0    0    -1  
$EndComp
Text Notes 2150 6200 0    60   ~ 0
C0805W472KDRACTU
$Comp
L power:Earth_Protective #PWR0118
U 1 1 5E1D66A0
P 2950 5700
F 0 "#PWR0118" H 3200 5450 50  0001 C CNN
F 1 "Earth_Protective" H 3400 5550 50  0001 C CNN
F 2 "" H 2950 5600 50  0001 C CNN
F 3 "~" H 2950 5600 50  0001 C CNN
	1    2950 5700
	1    0    0    -1  
$EndComp
Connection ~ 2950 5700
Wire Wire Line
	2050 5700 2050 5900
Connection ~ 2050 5700
$Comp
L Device:R R38
U 1 1 5E1EE096
P 1700 6000
F 0 "R38" H 1770 6046 50  0000 L CNN
F 1 "1M" H 1770 5955 50  0000 L CNN
F 2 "Resistor_SMD:R_0805_2012Metric" V 1630 6000 50  0001 C CNN
F 3 "~" H 1700 6000 50  0001 C CNN
	1    1700 6000
	1    0    0    -1  
$EndComp
Wire Wire Line
	1700 5850 1700 5700
Wire Wire Line
	1700 5700 2050 5700
Wire Wire Line
	1700 6150 1700 6250
Wire Wire Line
	1700 6250 2050 6250
Connection ~ 2050 6250
Wire Wire Line
	2050 6250 2050 6300
Wire Wire Line
	2050 6100 2050 6250
$Comp
L power:+BATT #PWR0119
U 1 1 5E22C2C9
P 2250 3250
F 0 "#PWR0119" H 2250 3100 50  0001 C CNN
F 1 "+BATT" H 2265 3423 50  0000 C CNN
F 2 "" H 2250 3250 50  0001 C CNN
F 3 "" H 2250 3250 50  0001 C CNN
	1    2250 3250
	1    0    0    -1  
$EndComp
Wire Wire Line
	6000 2050 6400 2050
Text Notes 1050 1450 0    60   ~ 0
Molex 0530480650
$EndSCHEMATC
